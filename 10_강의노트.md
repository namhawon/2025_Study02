# 데이터 전처리 강의 노트

## 데이터 전처리의 개요

**데이터 전처리는 데이터의 품질을 향상시키고 모델의 성능을 개선하는 핵심 과정**입니다. 데이터 전처리는 다음과 같은 작업들을 포함합니다:

- 데이터의 결측값 처리
- 데이터의 이상값 처리
- 데이터의 범위 조정
- 데이터의 변환
- 데이터의 차원 축소

## 1. 데이터 정제

### 1.1 결측치 탐색

결측치는 비어있거나 누락된 값으로, 데이터셋의 품질에 직접적인 영향을 미칩니다. 결측치는 다음과 같은 형태로 나타납니다:

- **NA(Not Available)**: 사용하지 않는 값
- **NaN(Not a Number)**: 숫자가 아닌 데이터
- **Null**: 아직 정해지지 않은 빈 값

**Pandas를 활용한 결측치 탐색 방법**:
```python
import pandas as pd
df = pd.read_csv('iris.csv')
df.info()               # 컬럼별 비결측 데이터 수 확인
df.isnull().sum()       # 컬럼별 결측치 개수 확인
df.isna().sum()         # 동일한 기능, 결측치 개수 확인
```

### 1.2 결측치 처리

결측치 처리는 다음과 같은 방법들이 있습니다:

1. **결측치 포함 행 제거**:
   ```python
   df.dropna(how='any')
   ```

2. **결측치 채우기**:
   ```python
   df.fillna(0, inplace=True)
   ```

3. **결측치 변경**:
   ```python
   df.replace(np.nan, 0)
   ```

### 2.1 중복값 처리

데이터셋의 품질을 높이기 위해 중복값을 확인하고 처리합니다:

1. **중복 데이터 확인**:
   ```python
   import pandas as pd
   df = pd.read_csv('iris.csv')
   df[df.duplicated()]
   ```

2. **중복 데이터 제거**:
   ```python
   df2 = df.drop_duplicates()
   ```

### 3.1 이상치 탐색

이상치는 정상값이 아닌 값으로, 다음과 같이 발생할 수 있습니다:
- 데이터 입력 오류
- 측정, 실험 오류
- 의도된 이상값

이상치가 중요한 이유
- 통계 분석 왜곡: 평균, 표준편차 등의 통계량에 큰 영향
- 모델 성능 저하: 머신러닝 모델의 예측 정확도 감소
- 잘못된 결론: 부정확한 분석 결과나 의사결정으로 이어질 수 있음

**이상치 탐색 방법**:
1. **기초 통계량 사용**:
   ```python
   df.describe()
   ```

2. **데이터 정렬**:
   ```python
   iris_data.sort_values(by=['petal_length'], ascending=False)
   ```

3. **시각화**:
   ```python
   plt.scatter(x=iris_data['petal_length'], y=iris_data['petal_width'])
   plt.show()
   ```

4. **박스플롯 및 IQR 공식 활용**:
   ```python
   import matplotlib.pyplot as plt
   plt.boxplot(wine['color_intensity'], whis=1.5)
   plt.title('color_intensity')
   plt.show()
   ```

### 3.2 사분위를 사용한 이상치 탐지와 제거

1. **사분위수(Quartiles)의 정의**:
- 데이터를 크기 순으로 정렬했을 때, 데이터를 4등분하는 지점의 값입니다.
- 제1사분위수(Q1): 데이터를 오름차순으로 정렬했을 때 하위 25% 위치의 값 Q1 = df['열'].quantile(0.25)
- 제2사분위수(Q2 또는 중앙값): 데이터의 중앙값(50% 위치)                      
- 제3사분위수(Q3): 데이터의 상위 25% 위치의 값(하위 75% 위치)           Q3 = df['열'].quantile(0.75)         

2. **사분위수 범위(Interquartile Range, IQR)**:
- Q3에서 Q1을 뺀 값으로, 데이터의 중간 50%가 퍼져 있는 범위를 나타냅니다.
- IQR = Q3 - Q1

3. **IQR을 이용한 이상치 탐지 방법**:
- Q3에서 Q1을 뺀 값으로, 데이터의 중간 50%가 퍼져 있는 범위를 나타냅니다.
- IQR = Q3 - Q1

   3.1 **이상치 경계 계산**
   - 하한 경계(Lower Bound): Q1 - 1.5 × IQR
   - 상한 경계(Upper Bound): Q3 + 1.5 × IQR
   
   3.2 **이상치 판별 기준**
   - 하한 경계 미만의 값: 이상치
   - 상한 경계 초과의 값: 이상치
   
   3.3 **이상치 탐지 과정**
   - 데이터에서 Q1, Q3, IQR 계산
   - 하한 경계와 상한 경계 계산
   - 경계를 벗어나는 값 식별하고 제거

### 📝 실습문제
다음 데이터에 대해 IQR을 계산하고 이상치를 찾아보세요.

```python
data = pd.Series([10, 11, 12, 13, 14, 15, 100, 101])
```

- Q1, Q3, IQR 계산
- 하한, 상한 계산
- 이상치 확인

## 2. 예제 데이터셋

### 2.1 scikit-learn 라이브러리 예제 데이터셋

| 종류 | 내용 | 로드명령 |
|------|------|----------|
| 보스턴 주택 가격 | | `load_boston()` |
| 붓꽃 품종 | iris 데이터 세트로, 꽃잎과 꽃받침의 길이 및 너비 측정값을 포함 | `load_iris()` |
| 손글씨 숫자 | | `load_digits()` |
| 와인종류 | | `load_wine()` |
| 당노병 진행 상황 | | `load_diabetes()` |

```python
from sklearn.datasets import load_iris
data = load_iris()
```

### 2.2 seaborn 라이브러리 예제 데이터셋

| 종류 | 내용 |
|------|------|
| diamonds | 50,000개 이상의 다이아몬드에 대한 가격과 속성(카럿, 컷, 색상 등)을 포함 |
| tips | 당에서 팁을 남긴 고객들에 대한 데이터 |
| iris | 붓꽃 데이터 세트 |
| titanic | 타이타닉호 승객에 대한 데이터 |
| flights | 1949~1960년까지의 월별 항공 여행 승객 수 데이터 |

```python
import seaborn as sns
data = sns.load_dataset('titanic')
```

### 2.3 Kaggle(https://www.kaggle.com/)

- 데이터 사이언스 대회 플랫폼
- 다양한 데이터셋과 분석 예제 제공

## 3. 실습 예제

### 3.1 붓꽃 데이터 분석

**데이터 설명**:
- 붓꽃의 3가지 종(setosa, versicolor, virginica)을 특성에 맞게 분류
- 꽃잎과 꽃받침의 너비와 길이를 측정한 데이터
- 150개의 레코드로 구성

**필드의 이해**:
- Sepal length: 꽃받침 길이 정보
- Sepal width: 꽃받침 너비 정보
- Petal length: 꽃잎 길이 정보
- Petal width: 꽃잎 너비 정보
- species: 꽃의 종류

**데이터 전처리 과정**:
1. 결측치 확인
2. 중복 데이터 확인 및 처리
3. 데이터 그룹핑 (품종별 통계 산출)
4. 데이터 시각화 (막대 그래프, 히스토그램, 산점도)

### 3.2 타이타닉 데이터 분석

**데이터 설명**:
- 데이터 사이언스와 머신러닝 분야 입문자용 데이터셋
- 캐글에서 가장 많이 사용되는 데이터
- 타이타닉호 사건의 생존자와 사망자를 구분하는 요인 분석

**주요 필드**:
- passengerId: 승객 번호
- Survived: 생존 여부 (0=사망, 1=생존)
- Pclass: 객실 등급 (1, 2, 3등급)
- Sex: 성별 (male/female)
- Age: 나이
- Sibsp: 함께 탑승한 형제 및 배우자 수
- Parch: 함께 탑승한 자녀 및 부모 수
- Fare: 탑승 요금

**데이터 전처리 과정**:
1. 결측치 확인
2. 결측치가 많은 컬럼(Deck) 삭제
3. 결측치가 적은 컬럼(Embarked)은 최빈값으로 대체
4. 나이의 결측치는 평균값으로 대체
5. 데이터 그룹핑 및 시각화 (막대 그래프, 히트맵)

## 데이터 전처리의 중요성

데이터 전처리는 데이터 분석과 모델링 과정에서 가장 기본적이면서도 중요한 단계입니다. 올바른 전처리를 통해 데이터의 품질을 향상시키고, 정확한 분석 결과를 얻을 수 있습니다. 결측치, 이상치, 중복값 등을 적절히 처리함으로써 데이터의 품질을 높이고 모델의 성능을 향상시킬 수 있습니다.
